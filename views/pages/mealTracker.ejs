<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include('../partials/head'); %>
  </head>
  <body>
    <header><%- include('../partials/headerLoggedin'); %></header>
    <div class="container">
      <div class="content">
        <div class="box">
          <h1>Meal Tracker</h1>
          <p>
            Log dine yndlings måltider!
          </p>
          <form action="/mealtracker/trackMeal" method="POST">

            <div class="labelPair">
              
              <select name="MealID" id="MealID">
                <% console.log(meals); %>
                  <% meals.forEach(function(meal) { %>
                      <option value="<%= meal.ID %>"><%= meal.Name %></option>
                  <% }); %>
              </select>
            </div>
            <div class="labelPair">
              <label for="Amount">Hvor meget af dette måltid spiste du? (Gram)</label>
              <input
                type="number"
                name="Amount"
                id="Amount"
      
              />
            </div>
            <div class="labelPair">
              <label for="dateTime">Tidspunkt</label>
              <input
                type="datetime-local"
                name="dateTime"
                id="dateTime">
            </div>

                <!-- hidden fields for geolocation -->
    <input type="hidden" name="latitude" id="latitude">
    <input type="hidden" name="longitude" id="longitude">

            <button type="submit">Log Meal</button>
          </form>
        </div>
        <div class="box">
          <img src="/images/start.png" alt="start image" />
        </div>
      </div>
    </div>
    <footer><%- include('../partials/footer'); %></footer>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
          if (navigator.geolocation) {
              navigator.geolocation.getCurrentPosition(function(position) {
                  document.getElementById('latitude').value = position.coords.latitude;
                  document.getElementById('longitude').value = position.coords.longitude;
              }, function(error) {
                  console.error("Geolocation error: " + error.message);
              });
          } else {
              console.error("Geolocation is not supported by this browser.");
          }
      });
      </script>
  </body>
</html>
